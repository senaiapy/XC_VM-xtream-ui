# ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ —Ä–µ–ª–∏–∑–∞ XC\_VM

> –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –≤—ã–ø–æ–ª–Ω–∏ –≤—Å–µ –ø—É–Ω–∫—Ç—ã –ø–µ—Ä–µ–¥ –ø—É–±–ª–∏–∫–∞—Ü–∏–µ–π –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è.

---

## üî¢ 1. –û–±–Ω–æ–≤–∏—Ç—å –≤–µ—Ä—Å–∏—é

* –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å **–Ω–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ `XC_VM_VERSION`** –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Ñ–∞–π–ª–∞—Ö:

**–§–∞–π–ª—ã –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**

```
src/www/constants.php  
src/www/stream/init.php  
src/player/functions.php
```

**Auto-update –∫–æ–º–∞–Ω–¥–∞:**

```bash
find -type f -name "*.php" -exec sed -i \
"s/define('XC_VM_VERSION', '[0-9]\+\.[0-9]\+\.[0-9]\+');/define('XC_VM_VERSION', 'X.Y.Z');/g" {} \;
```

**–ó–∞–∫–æ–º–º–∏—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º:**

```bash
git add .
git commit -m "Bump version to X.Y.Z"
```

---

## üßπ 2. –£–¥–∞–ª—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

* –í—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É:

  ```bash
  make delete_files_list
  ```
* –û—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª `dist/deleted_files.txt`
* –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—É—Ç–∏ –∏–∑ —Å–ø–∏—Å–∫–∞ –¥–æ–±–∞–≤–∏—Ç—å –≤ `src/includes/cli/update.php` **–ø–æ—Å–ª–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è** `// Update checkpoint` —Å–ª–µ–¥—É—é—â–∏–π –±–ª–æ–∫:

  ```php
  if (file_exists(MAIN_HOME . 'file_path')) {
      unlink(MAIN_HOME . 'file_path');
  }
  ```

---

## ‚öôÔ∏è 3. –°–±–æ—Ä–∫–∞ –∞—Ä—Ö–∏–≤–æ–≤

* –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—ã:

  ```bash
  make lb
  make main
  make main_update
  make lb_update
  ```
* –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Å–æ–∑–¥–∞–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ —Ñ–∞–π–ª—ã:

  * `dist/loadbalancer.tar.gz` ‚Äî —É—Å—Ç–∞–Ω–æ–≤–æ—á–Ω—ã–π –∞—Ä—Ö–∏–≤ LB
  * `dist/loadbalancer_update.tar.gz` ‚Äî –∞—Ä—Ö–∏–≤ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è LB
  * `dist/XC_VM.zip` ‚Äî —É—Å—Ç–∞–Ω–æ–≤–æ—á–Ω—ã–π –∞—Ä—Ö–∏–≤ MAIN
  * `dist/update.tar.gz` ‚Äî –∞—Ä—Ö–∏–≤ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è MAIN
  * `dist/hashes.md5` ‚Äî —Ñ–∞–π–ª —Å —Ö–µ—à-—Å—É–º–º–∞–º–∏

---

## üìù 4. Changelog

–°–Ω–∞—á–∞–ª–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª —Å –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ –∏–∑ git:
```bash
git log --pretty=format:"- %s (%h)" X.Y.Z..main > dist/changes.md
```

---

*   **–ü–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ —Å—Å—ã–ª–∫–µ –∏ –¥–æ–±–∞–≤—å—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ —Ä–µ–ª–∏–∑–∞:**
    [https://github.com/Vateron-Media/XC_VM_Update/blob/main/changelog.json](https://github.com/Vateron-Media/XC_VM_Update/blob/main/changelog.json)

* –î–æ–±–∞–≤–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ —Ä–µ–ª–∏–∑–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON:

  ```json
  [
    {
        "version": "X.Y.Z",
        "changes": [
          "–û–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è 1",
          "–û–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è 2"
        ]
    }
  ]
  ```

---

## üöÄ 5. GitHub —Ä–µ–ª–∏–∑

* –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ä–µ–ª–∏–∑ –Ω–∞ [GitHub Releases](https://github.com/Vateron-Media/XC_VM/releases)
* –ü—Ä–∏–∫—Ä–µ–ø–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ —Ñ–∞–π–ª—ã –∫ —Ä–µ–ª–∏–∑—É:

  * `dist/loadbalancer.tar.gz`
  * `dist/XC_VM.zip`
  * `dist/update.tar.gz`
  * `dist/loadbalancer_update.tar.gz`
  * `dist/hashes.md5`
* –£–∫–∞–∑–∞—Ç—å changelog –≤ –æ–ø–∏—Å–∞–Ω–∏–∏ —Ä–µ–ª–∏–∑–∞

---

