# ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ —Ä–µ–ª–∏–∑–∞ XC_VM

<p align="center">
  –í —ç—Ç–æ–º –¥–æ–∫—É–º–µ–Ω—Ç–µ –æ–ø–∏—Å–∞–Ω –ø—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–Ω–∏—è —Ä–µ–ª–∏–∑–∞ <b>XC_VM</b> ‚Äî –ø–æ—à–∞–≥–æ–≤–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –ø–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—é –≤–µ—Ä—Å–∏–∏, —Å–±–æ—Ä–∫–µ –∞—Ä—Ö–∏–≤–æ–≤ –∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –Ω–∞ GitHub.
</p>

<p align="center">
  <a href="../ru/main-page.md"><b>‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –Ω–∞ –≥–ª–∞–≤–Ω—É—é</b></a>
</p>

---

## üìö –ù–∞–≤–∏–≥–∞—Ü–∏—è

- [üî¢ 1. –û–±–Ω–æ–≤–∏—Ç—å –≤–µ—Ä—Å–∏—é](#1-–æ–±–Ω–æ–≤–∏—Ç—å-–≤–µ—Ä—Å–∏—é)
- [üßπ 2. –£–¥–∞–ª—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã](#2-—É–¥–∞–ª—ë–Ω–Ω—ã–µ-—Ñ–∞–π–ª—ã)
- [‚öôÔ∏è 3. –°–±–æ—Ä–∫–∞ –∞—Ä—Ö–∏–≤–æ–≤](#3-—Å–±–æ—Ä–∫–∞-–∞—Ä—Ö–∏–≤–æ–≤)
- [üìù 4. Changelog](#4-changelog)
- [üöÄ 5. GitHub —Ä–µ–ª–∏–∑](#5-github-—Ä–µ–ª–∏–∑)

---

## üî¢ 1. –û–±–Ω–æ–≤–∏—Ç—å –≤–µ—Ä—Å–∏—é

* –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å **–Ω–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ `XC_VM_VERSION`** –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Ñ–∞–π–ª–∞—Ö:

**–§–∞–π–ª—ã –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**

```
src/www/constants.php  
src/www/stream/init.php  
src/player/functions.php
```

**Auto-update –∫–æ–º–∞–Ω–¥–∞:**

```bash
find -type f -name "*.php" -exec sed -i \
"s/define('XC_VM_VERSION', '[0-9]\+\.[0-9]\+\.[0-9]\+');/define('XC_VM_VERSION', 'X.Y.Z');/g" {} \;
```

**–ó–∞–∫–æ–º–º–∏—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º:**

```bash
git add .
git commit -m "Bump version to X.Y.Z"
```

> üí° **–°–æ–≤–µ—Ç:** –ó–∞–º–µ–Ω–∏—Ç–µ `X.Y.Z` –Ω–∞ –∞–∫—Ç—É–∞–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é, –Ω–∞–ø—Ä–∏–º–µ—Ä, `1.2.3`.

---

## üßπ 2. –£–¥–∞–ª—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

* –í—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–ø–∏—Å–∫–∞ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤:

  ```bash
  make delete_files_list
  ```

* –û—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª `dist/deleted_files.txt`.
* –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—É—Ç–∏ –∏–∑ —Å–ø–∏—Å–∫–∞ –¥–æ–±–∞–≤–∏—Ç—å –≤ `src/includes/cli/update.php` **–ø–æ—Å–ª–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è** `// Update checkpoint` —Å–ª–µ–¥—É—é—â–∏–π –±–ª–æ–∫:

  ```php
  if (file_exists(MAIN_HOME . 'file_path')) {
      unlink(MAIN_HOME . 'file_path');
  }
  ```

> ‚ö†Ô∏è **–í–∞–∂–Ω–æ:** –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø—É—Ç–∏ —É–∫–∞–∑–∞–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å —É–¥–∞–ª–µ–Ω–∏—è –≤–∞–∂–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤.

---

## ‚öôÔ∏è 3. –°–±–æ—Ä–∫–∞ –∞—Ä—Ö–∏–≤–æ–≤

* –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—ã –¥–ª—è —Å–±–æ—Ä–∫–∏:

  ```bash
  make lb
  make main
  make main_update
  make lb_update
  ```

* –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Å–æ–∑–¥–∞–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ —Ñ–∞–π–ª—ã –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `dist/`:

  - `loadbalancer.tar.gz` ‚Äî —É—Å—Ç–∞–Ω–æ–≤–æ—á–Ω—ã–π –∞—Ä—Ö–∏–≤ LB
  - `loadbalancer_update.tar.gz` ‚Äî –∞—Ä—Ö–∏–≤ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è LB
  - `XC_VM.zip` ‚Äî —É—Å—Ç–∞–Ω–æ–≤–æ—á–Ω—ã–π –∞—Ä—Ö–∏–≤ MAIN
  - `update.tar.gz` ‚Äî –∞—Ä—Ö–∏–≤ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è MAIN
  - `hashes.md5` ‚Äî —Ñ–∞–π–ª —Å —Ö–µ—à-—Å—É–º–º–∞–º–∏

> üß∞ **–ü—Ä–æ–≤–µ—Ä–∫–∞:** –ü–æ—Å–ª–µ —Å–±–æ—Ä–∫–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –∞—Ä—Ö–∏–≤–æ–≤ —Å –ø–æ–º–æ—â—å—é `md5sum -c hashes.md5`.

---

## üìù 4. Changelog

–°–Ω–∞—á–∞–ª–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª —Å –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ –∏–∑ git:

```bash
git log --pretty=format:"- %s (%h)" X.Y.Z..main > dist/changes.md
```

*   **–ü–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ —Å—Å—ã–ª–∫–µ –∏ –¥–æ–±–∞–≤—å—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ —Ä–µ–ª–∏–∑–∞:**
    [https://github.com/Vateron-Media/XC_VM_Update/blob/main/changelog.json](https://github.com/Vateron-Media/XC_VM_Update/blob/main/changelog.json)

* –î–æ–±–∞–≤–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ —Ä–µ–ª–∏–∑–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON:

  ```json
  [
    {
        "version": "X.Y.Z",
        "changes": [
          "–û–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è 1",
          "–û–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è 2"
        ]
    }
  ]
  ```

> üí¨ **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–µ—Ä–∂–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –∫—Ä–∞—Ç–∫–∏–º–∏ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–º–∏, —Ñ–æ–∫—É—Å–∏—Ä—É—è—Å—å –Ω–∞ –∫–ª—é—á–µ–≤—ã—Ö —É–ª—É—á—à–µ–Ω–∏—è—Ö –∏ —Ñ–∏–∫—Å–∞—Ö.

---

## üöÄ 5. GitHub —Ä–µ–ª–∏–∑

* –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ä–µ–ª–∏–∑ –Ω–∞ [GitHub Releases](https://github.com/Vateron-Media/XC_VM/releases).
* –ü—Ä–∏–∫—Ä–µ–ø–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ —Ñ–∞–π–ª—ã –∫ —Ä–µ–ª–∏–∑—É:

  - `dist/loadbalancer.tar.gz`
  - `dist/XC_VM.zip`
  - `dist/update.tar.gz`
  - `dist/loadbalancer_update.tar.gz`
  - `dist/hashes.md5`

* –£–∫–∞–∑–∞—Ç—å changelog –≤ –æ–ø–∏—Å–∞–Ω–∏–∏ —Ä–µ–ª–∏–∑–∞.

> ‚úÖ **–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ:** –ü–æ—Å–ª–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å–µ —Ñ–∞–π–ª—ã –¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –∏ —Ö–µ—à-—Å—É–º–º—ã —Å–æ–≤–ø–∞–¥–∞—é—Ç.

---

<p align="center">
  <a href="../ru/main-page.md"><b>‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –Ω–∞ –≥–ª–∞–≤–Ω—É—é</b></a>
</p>

---